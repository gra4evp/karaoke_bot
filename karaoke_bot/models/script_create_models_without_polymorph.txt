CREATE TABLE accounts (
	id INTEGER NOT NULL, 
	is_visitor BOOLEAN, 
	is_owner BOOLEAN, 
	is_moderator BOOLEAN, 
	is_administrator BOOLEAN, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (id)
)


CREATE TABLE tracks (
	id INTEGER NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (id)
)


CREATE TABLE artist (
	id INTEGER NOT NULL, 
	name VARCHAR(64) NOT NULL, 
	PRIMARY KEY (id)
)


CREATE TABLE telegram_profiles (
	account_id INTEGER NOT NULL, 
	id INTEGER NOT NULL, 
	is_bot BOOLEAN NOT NULL, 
	first_name VARCHAR(64) NOT NULL, 
	last_name VARCHAR(64) NOT NULL, 
	username VARCHAR(32), 
	language_code VARCHAR(10) NOT NULL, 
	is_premium BOOLEAN,
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (account_id), 
	FOREIGN KEY(account_id) REFERENCES accounts (id)
)


CREATE TABLE owners (
	account_id INTEGER NOT NULL, 
	password VARCHAR(255) NOT NULL, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (account_id), 
	FOREIGN KEY(account_id) REFERENCES accounts (id)
)


CREATE TABLE administrators (
	account_id INTEGER NOT NULL, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (account_id), 
	FOREIGN KEY(account_id) REFERENCES accounts (id)
)


CREATE TABLE track_versions (
	id INTEGER NOT NULL, 
	track_id INTEGER NOT NULL, 
	url VARCHAR(2048) NOT NULL, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(track_id) REFERENCES tracks (id)
)


CREATE TABLE tracks_artists (
	track_id INTEGER, 
	artist_id INTEGER, 
	FOREIGN KEY(track_id) REFERENCES tracks (id), 
	FOREIGN KEY(artist_id) REFERENCES artist (id)
)


CREATE TABLE karaoke (
	id INTEGER NOT NULL, 
	name VARCHAR(255) NOT NULL, 
	active BOOLEAN NOT NULL, 
	owner_id INTEGER NOT NULL, 
	avatar_id INTEGER NOT NULL, 
	description VARCHAR(255) NOT NULL, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (name), 
	FOREIGN KEY(owner_id) REFERENCES owners (account_id)
)



CREATE TABLE visitors (
	account_id INTEGER NOT NULL, 
	selected_karaoke_id INTEGER, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (account_id), 
	FOREIGN KEY(account_id) REFERENCES accounts (id), 
	FOREIGN KEY(selected_karaoke_id) REFERENCES karaoke (id)
)


CREATE TABLE moderators (
	account_id INTEGER NOT NULL, 
	karaoke_id INTEGER NOT NULL, 
	created_at DATETIME DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	updated_at TIMESTAMP DEFAULT (CURRENT_TIMESTAMP) NOT NULL, 
	PRIMARY KEY (account_id), 
	FOREIGN KEY(account_id) REFERENCES accounts (id), 
	FOREIGN KEY(karaoke_id) REFERENCES karaoke (id)
)


CREATE TABLE sessions (
	id INTEGER NOT NULL, 
	karaoke_id INTEGER NOT NULL, 
	timestamp_from DATETIME NOT NULL, 
	timestamp_to DATETIME NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(karaoke_id) REFERENCES karaoke (id)
)


CREATE TABLE visitor_performances (
	id INTEGER NOT NULL, 
	visitor_id INTEGER NOT NULL, 
	track_version_id INTEGER NOT NULL, 
	session_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(visitor_id) REFERENCES visitors (account_id), 
	FOREIGN KEY(track_version_id) REFERENCES track_versions (id), 
	FOREIGN KEY(session_id) REFERENCES sessions (id)
)
